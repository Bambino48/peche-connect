<section class="products-page">

  <!-- HEADER -->
  <div class="page-header">
    <div>
      <h1>Mes produits</h1>
      <p>G√©rez vos produits de p√™che (ajout, modification, suppression)</p>
    </div>

    <div class="page-actions">
      <button class="btn-primary" routerLink="/products/add">
        + Ajouter un produit
      </button>

      <button class="btn-secondary" routerLink="/actions">
        Retour
      </button>
    </div>
  </div>

  <!-- CHARGEMENT -->
  <div *ngIf="loading" class="products-grid skeleton-grid">
    <div class="product-card skeleton-card" *ngFor="let _ of [1, 2, 3, 4, 5, 6]">
      <div class="card-media skeleton-media"></div>
      <div class="skeleton-line title"></div>
      <div class="skeleton-line"></div>
      <div class="skeleton-line"></div>
      <div class="skeleton-line"></div>
      <div class="skeleton-actions">
        <div class="skeleton-button"></div>
        <div class="skeleton-button"></div>
      </div>
    </div>
  </div>

  <!-- ERREUR -->
  <div *ngIf="!loading && errorMessage" class="error-banner">
    ‚ö†Ô∏è {{ errorMessage }}
  </div>

  <!-- LISTE -->
  <ng-container *ngIf="!loading && !errorMessage">
    <div class="empty-state" *ngIf="activeProducts.length === 0">
      Aucun produit pour le moment.
    </div>

    <div class="products-grid" *ngIf="activeProducts.length">
      <ng-container *ngFor="let product of activeProducts">
        <div class="product-card">
          <div class="card-media">
            <ng-container *ngIf="product.photoUrl; else photoFallback">
              <img [src]="product.photoUrl"
                [alt]="product.fishType === 'AUTRE' ? (product.otherFishName || 'Poisson') : (product.fishType || 'Poisson')" />
            </ng-container>
            <ng-template #photoFallback>
              <div class="image-placeholder">
                <span class="placeholder-icon">üêü</span>
                <span>Aucune image</span>
              </div>
            </ng-template>
            <div class="image-overlay"></div>
            <span class="status-badge" [ngClass]="{
                active: product.status === 'ACTIF',
                sold: product.status === 'VENDU',
                inactive: product.status === 'DESACTIVE'
              }">
              <span class="badge-dot">‚óè</span>
              {{ product.status || '‚Äî' }}
            </span>
          </div>

          <div class="card-header">
            <div>
              <h3>{{ product.fishType === 'AUTRE' ? (product.otherFishName || 'Poisson') : (product.fishType ||
                'Poisson') }}</h3>
              <span class="subtitle">{{ product.fishingZone || '‚Äî' }} ‚Ä¢ {{ product.conservationMethod ?? 'Non pr√©cis√©'
                }}</span>
            </div>
          </div>

          <div class="card-body">
            <div class="price">{{ product.pricePerKg !== null && product.pricePerKg !== undefined ? (product.pricePerKg
              + ' FCFA / kg') : '‚Äî' }}</div>
            <div class="meta">
              <span>{{ product.quantityKg !== null && product.quantityKg !== undefined ? (product.quantityKg + ' kg
                disponibles') : '‚Äî' }}</span>
              <span class="meta-sep">‚Ä¢</span>
              <span>{{ product.fishingDate | date:'d MMM yyyy' }}</span>
            </div>
            <div class="seller">Vendeur : {{ product.sellerType || '‚Äî' }}</div>
          </div>

          <div class="card-actions">
            <button class="btn-edit" [routerLink]="['/products/edit', product.id]">
              Modifier
            </button>

            <button class="btn-delete">
              Supprimer
            </button>
          </div>
        </div>
      </ng-container>
    </div>
  </ng-container>

</section>