<section class="products-page">

  <!-- HEADER -->
  <div class="page-header">
    <div>
      <h1>Mes produits</h1>
      <p>Gérez vos produits de pêche (ajout, modification, suppression)</p>
    </div>

    <div class="page-actions">
      <button class="btn-primary" routerLink="/products/add">
        + Ajouter un produit
      </button>

      <button class="btn-secondary" routerLink="/actions">
        Retour
      </button>
    </div>
  </div>

  <!-- CHARGEMENT -->
  <div *ngIf="loading" class="loading-state">
    Chargement des produits...
  </div>

  <!-- ERREUR -->
  <div *ngIf="!loading && errorMessage" class="error-banner">
    ⚠️ {{ errorMessage }}
  </div>

  <!-- LISTE -->
  <ng-container *ngIf="!loading && !errorMessage">
    <div class="empty-state" *ngIf="activeProducts.length === 0">
      Aucun produit pour le moment.
    </div>

    <div class="products-grid" *ngIf="activeProducts.length">
      <ng-container *ngFor="let product of activeProducts">
        <div class="product-card">
          <div class="card-media">
            <ng-container *ngIf="product.photoUrl; else photoFallback">
              <img [src]="product.photoUrl"
                [alt]="product.fishType === 'AUTRE' ? (product.otherFishName || 'Poisson') : (product.fishType || 'Poisson')" />
            </ng-container>
            <ng-template #photoFallback>
              <div class="image-placeholder">Photo indisponible</div>
            </ng-template>
          </div>

          <div class="card-header">
            <div>
              <h3>{{ product.fishType === 'AUTRE' ? (product.otherFishName || 'Poisson') : (product.fishType ||
                'Poisson')
                }}</h3>
              <span class="scientific">{{ product.fishType || '—' }}</span>
            </div>

            <span class="status available">
              {{ product.status || '—' }}
            </span>
          </div>

          <div class="card-body">
            <div><strong>Prix/kg :</strong> {{ product.pricePerKg !== null && product.pricePerKg !== undefined ?
              (product.pricePerKg + ' FCFA / kg') : '—' }}</div>
            <div><strong>Quantité :</strong> {{ product.quantityKg !== null && product.quantityKg !== undefined ?
              (product.quantityKg + ' kg') : '—' }}</div>
            <div><strong>Zone :</strong> {{ product.fishingZone || '—' }}</div>
            <div><strong>Date :</strong> {{ product.fishingDate || '—' }}</div>
            <div><strong>Conservation :</strong> {{ product.conservationMethod ?? 'Non précisé' }}</div>
            <div><strong>Vendeur :</strong> {{ product.sellerType || '—' }}</div>
          </div>

          <div class="card-actions">
            <button class="btn-edit" [routerLink]="['/products/edit', product.id]">
              Modifier
            </button>

            <button class="btn-delete">
              Supprimer
            </button>
          </div>
        </div>
      </ng-container>
    </div>
  </ng-container>

</section>